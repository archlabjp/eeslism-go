# WEEK（週間カレンダー定義）

## 概要
WEEK（Week Calendar）は、特定の日付に対する曜日を明示的に指定するデータセットです。基準となる曜日を設定することで、年間を通じた正確な曜日判定を行い、スケジュール制御の基盤を提供します。省略時はdayweek.eflの設定が使用されますが、特定の年や地域の祝日・特別日を考慮したカスタマイズが可能です。

## データ形式
```
WEEK
    <月/日>=<曜日> ;
    <月/日>=<曜日> ;
    ... 繰り返し
*
```

## パラメータ説明

| パラメータ | 説明 | 設定値 | 参照 |
|:---|:---|:---|:---|
| 月/日 | 日付（MM/DD形式） | 01/01-12/31 | 必須 |
| 曜日 | 曜日コード | Sun,Mon,Tue,Wed,Thu,Fri,Sat,Hol | 必須 |

## 曜日コード一覧

| コード | 曜日 | 説明 |
|:---|:---|:---|
| `Sun` | 日曜日 | Sunday |
| `Mon` | 月曜日 | Monday |
| `Tue` | 火曜日 | Tuesday |
| `Wed` | 水曜日 | Wednesday |
| `Thu` | 木曜日 | Thursday |
| `Fri` | 金曜日 | Friday |
| `Sat` | 土曜日 | Saturday |
| `Hol` | 祝日 | Holiday |

## 使用例

### 基本的な曜日設定
```
WEEK
    1/1=Sun ;
    1/2=Mon ;
    1/3=Tue ;
*
```

### 祝日の設定
```
WEEK
    1/1=Hol ;     !  元日
    1/8=Hol ;     !  成人の日（第2月曜日）
    2/11=Hol ;    !  建国記念の日
    2/23=Hol ;    !  天皇誕生日
    3/20=Hol ;    !  春分の日
    4/29=Hol ;    !  昭和の日
    5/3=Hol ;     !  憲法記念日
    5/4=Hol ;     !  みどりの日
    5/5=Hol ;     !  こどもの日
    7/15=Hol ;    !  海の日（第3月曜日）
    8/11=Hol ;    !  山の日
    9/16=Hol ;    !  敬老の日（第3月曜日）
    9/23=Hol ;    !  秋分の日
    10/14=Hol ;   !  体育の日（第2月曜日）
    11/3=Hol ;    !  文化の日
    11/23=Hol ;   !  勤労感謝の日
    12/23=Hol ;   !  天皇誕生日（旧）
*
```

### 年度始まりの設定
```
WEEK
    4/1=Mon ;     !  年度始まり（月曜日）
*
```

### 特定年の設定例（2024年）
```
WEEK
    1/1=Mon ;     !  2024年元日
    1/8=Mon ;     !  成人の日
    2/11=Sun ;    !  建国記念の日
    2/12=Mon ;    !  振替休日
    2/23=Fri ;    !  天皇誕生日
    3/20=Wed ;    !  春分の日
    4/29=Mon ;    !  昭和の日
    5/3=Fri ;     !  憲法記念日
    5/4=Sat ;     !  みどりの日
    5/5=Sun ;     !  こどもの日
    5/6=Mon ;     !  振替休日
    7/15=Mon ;    !  海の日
    8/11=Sun ;    !  山の日
    8/12=Mon ;    !  振替休日
    9/16=Mon ;    !  敬老の日
    9/22=Sun ;    !  秋分の日
    9/23=Mon ;    !  振替休日
    10/14=Mon ;   !  スポーツの日
    11/3=Sun ;    !  文化の日
    11/4=Mon ;    !  振替休日
    11/23=Sat ;   !  勤労感謝の日
*
```

## 振替休日の処理

### 基本ルール
- 祝日が日曜日の場合、翌月曜日が振替休日
- 祝日が土曜日の場合、地域・組織により異なる

### 振替休日の設定例
```
WEEK
    5/5=Sun ;     !  こどもの日（日曜日）
    5/6=Hol ;     !  振替休日（月曜日）
*
```

## 地域・組織別のカスタマイズ

### 学校年度対応
```
WEEK
    4/1=Mon ;     !  新学期開始
    7/20=Sat ;    !  夏休み開始
    8/31=Sat ;    !  夏休み終了
    12/25=Wed ;   !  冬休み開始
    1/7=Tue ;     !  冬休み終了
*
```

### 企業カレンダー対応
```
WEEK
    12/29=Hol ;   !  年末休暇
    12/30=Hol ;   !  年末休暇
    12/31=Hol ;   !  大晦日
    1/2=Hol ;     !  正月休暇
    1/3=Hol ;     !  正月休暇
*
```

### 工場稼働カレンダー
```
WEEK
    8/13=Hol ;    !  夏季休暇
    8/14=Hol ;    !  夏季休暇
    8/15=Hol ;    !  夏季休暇
    8/16=Hol ;    !  夏季休暇
*
```

## デフォルト設定との関係

### dayweek.eflとの連携
- WEEK定義がない場合、dayweek.eflの設定を使用
- WEEK定義がある場合、明示的な設定が優先
- 部分的な定義も可能（未定義日はdayweek.eflを参照）

### 基準日の重要性
```
WEEK
    1/1=Sun ;     !  基準日を設定
*
```
この設定により、年間の曜日が自動計算されます。

## スケジュール制御への影響

### 曜日グループとの連携
SCHTB.mdで定義された曜日グループと連携：
```
!  SCHTB.mdでの定義
-wkd Weekday Mon Tue Wed Thu Fri ;
-wkd Weekend Sat Sun Hol ;

!  WEEK.mdでの祝日設定
1/1=Hol ;  !  この日はWeekendグループとして扱われる
```

### スケジュール適用例
```
!  平日スケジュール: 月～金曜日
!  週末スケジュール: 土・日曜日・祝日
```

## 年間カレンダーの生成

### 自動計算機能
基準日から年間の曜日を自動計算：
1. 基準日の曜日を設定
2. 日付の加算により各日の曜日を計算
3. 明示的な祝日設定を適用

### うるう年の考慮
- 2月29日の存在を自動判定
- うるう年の日付計算を正確に実行

## 国際化対応

### 異なる週始まり
```
!  日本（日曜始まり）
1/1=Sun ;

!  欧米（月曜始まり）
1/1=Mon ;
```

### 地域別祝日
```
!  日本の祝日
1/1=Hol ;     !  元日
5/3=Hol ;     !  憲法記念日

!  アメリカの祝日
7/4=Hol ;     !  独立記念日
11/28=Hol ;   !  感謝祭
```

## 設計上の注意事項

1. **基準日設定**: 年始の基準日を正確に設定
2. **祝日更新**: 年度ごとの祝日変更に対応
3. **振替処理**: 振替休日の適切な処理
4. **組織対応**: 組織固有の休日設定

## デバッグとテスト

### カレンダー確認
1. **年間表示**: 全年のカレンダー表示
2. **祝日確認**: 祝日の正確な設定確認
3. **曜日計算**: 基準日からの曜日計算検証

### スケジュール連携テスト
- 曜日グループの適切な適用
- 祝日スケジュールの正常動作
- 振替休日の処理確認

## 出力データ

週間カレンダーに関する以下の項目が出力されます：
- 各日の曜日判定結果
- 祝日・特別日の識別
- スケジュールグループの適用状況

## 関連データセット

- [SCHTB](SCHTB.md): 曜日グループ定義との連携
- [SCHNM](SCHNM.md): スケジュール名定義での活用
- [RESI](RESI.md): 居住者スケジュールでの曜日判定
- [AAPL](AAPL.md): 照明・機器スケジュールでの曜日判定
- [VENT](VENT.md): 換気スケジュールでの曜日判定

## 関連ファイル

- **dayweek.efl**: デフォルトの週間カレンダー設定ファイル